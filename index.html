<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æåŒ»ç”Ÿå£è…”è¯Šå®¤ Â· æœªæ¥å½±åƒä¸­å¿ƒ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://lf-cdn.coze.cn/obj/unpkg/flow-platform/chat-app-sdk/1.2.0-beta.19/libs/cn/index.js"></script>
    <style>
        /* å…¨å±€åŸºç¡€è®¾å®š */
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: #000; }
        
        /* èƒŒæ™¯ç²’å­ç”»å¸ƒ */
        #bg-canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: -2; }

        /* å·¦ä¾§ 3D æ¨¡å‹å®¹å™¨ */
        #left-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 50%; /* å æ®å·¦åŠè¾¹å±å¹• */
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: -1;
            pointer-events: none; /* è®©é¼ æ ‡äº‹ä»¶ç©¿é€ï¼Œä¸å½±å“æ“ä½œ */
        }

        /* å¼ºåˆ¶éšè—å³ä¸‹è§’çš„å°æ°”æ³¡æŒ‰é’®ï¼Œå› ä¸ºæˆ‘ä»¬è¦è®©å®ƒè‡ªåŠ¨å¼¹çª— */
        .coze-web-sdk-bubble-icon { display: none !important; }
    </style>
</head>
<body>
    <canvas id="bg-canvas"></canvas>
    
    <div id="left-container"></div>

    <script>
        // =================================================================
        // ç¬¬ä¸€éƒ¨åˆ†ï¼šç»å¯¹å¤±å¿†é€»è¾‘ï¼ˆè§£å†³ä½ æœ€ä»‹æ„çš„é—®é¢˜ï¼‰
        // =================================================================
        // æ¯æ¬¡åˆ·æ–°é¡µé¢ï¼Œç”Ÿæˆä¸€ä¸ªåŸºäºå½“å‰æ¯«ç§’çº§æ—¶é—´æˆ³çš„å”¯ä¸€ ID
        const uniquePatientId = 'patient_' + Date.now().toString(36) + Math.random().toString(36).substr(2);
        console.log("ğŸš€ å…¨æ–°æ‚£è€…IDå·²ç”Ÿæˆï¼Œè®°å¿†å·²æ¸…é™¤:", uniquePatientId);


        // =================================================================
        // ç¬¬äºŒéƒ¨åˆ†ï¼šèƒŒæ™¯ç²’å­ç‰¹æ•ˆ (ä¿æŒåŸæœ‰é£å‘³)
        // =================================================================
        const bgCanvas = document.getElementById('bg-canvas');
        const bgCtx = bgCanvas.getContext('2d');
        let particles = [];
        function initBgCanvas() {
            bgCanvas.width = window.innerWidth;
            bgCanvas.height = window.innerHeight;
            particles = [];
            for(let i=0; i<150; i++) { // å¢åŠ ç²’å­æ•°é‡è®©èƒŒæ™¯æ›´ä¸°å¯Œ
                particles.push({
                    x: Math.random() * bgCanvas.width,
                    y: Math.random() * bgCanvas.height,
                    vx: (Math.random() - 0.5) * 0.3,
                    vy: (Math.random() - 0.5) * 0.3,
                    size: Math.random() * 1.5,
                    alpha: Math.random() * 0.5 + 0.2
                });
            }
        }
        function animateBg() {
            bgCtx.clearRect(0, 0, bgCanvas.width, bgCanvas.height);
            particles.forEach(p => {
                p.x += p.vx; p.y += p.vy;
                if(p.x < 0 || p.x > bgCanvas.width) p.vx *= -1;
                if(p.y < 0 || p.y > bgCanvas.height) p.vy *= -1;
                bgCtx.beginPath();
                bgCtx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
                bgCtx.fillStyle = `rgba(0, 195, 255, ${p.alpha})`;
                bgCtx.fill();
            });
            requestAnimationFrame(animateBg);
        }
        window.addEventListener('resize', initBgCanvas);
        initBgCanvas();
        animateBg();


        // =================================================================
        // ç¬¬ä¸‰éƒ¨åˆ†ï¼šå·¦ä¾§ç§‘å¹» 3D æ—‹è½¬æ¨¡å‹ (ä»£æ›¿ CT ç‰™é½¿)
        // =================================================================
        const leftContainer = document.getElementById('left-container');
        const scene = new THREE.Scene();
        // ä½¿ç”¨å®¹å™¨çš„å®½é«˜æ¯”
        const camera = new THREE.PerspectiveCamera(75, leftContainer.clientWidth / leftContainer.clientHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true }); // alpha: true è®©èƒŒæ™¯é€æ˜
        renderer.setSize(leftContainer.clientWidth, leftContainer.clientHeight);
        leftContainer.appendChild(renderer.domElement);

        // åˆ›å»ºä¸€ä¸ªç§‘å¹»æ„Ÿçš„å¤šé¢ä½“å‡ ä½•ä½“ (IcosahedronGeometry)
        const geometry = new THREE.IcosahedronGeometry(2, 1); // åŠå¾„ä¸º2ï¼Œç»†èŠ‚ç­‰çº§ä¸º1
        // åˆ›å»ºå‘å…‰çš„è“è‰²çº¿æ¡†æè´¨
        const material = new THREE.MeshBasicMaterial({ 
            color: 0x00c3ff, 
            wireframe: true, 
            transparent: true, 
            opacity: 0.8 
        });
        const sciFiModel = new THREE.Mesh(geometry, material);
        scene.add(sciFiModel);

        camera.position.z = 5;

        // åŠ¨ç”»å¾ªç¯ï¼šè®©æ¨¡å‹æ—‹è½¬èµ·æ¥
        function animateModel() {
            requestAnimationFrame(animateModel);
            sciFiModel.rotation.x += 0.005;
            sciFiModel.rotation.y += 0.01;
            renderer.render(scene, camera);
        }
        animateModel();
        // çª—å£å¤§å°æ”¹å˜æ—¶æ›´æ–°ç›¸æœºå’Œæ¸²æŸ“å™¨
        window.addEventListener('resize', () => {
            const width = leftContainer.clientWidth;
            const height = leftContainer.clientHeight;
            camera.aspect = width / height;
            camera.updateProjectionMatrix();
            renderer.setSize(width, height);
        });


        // =================================================================
        // ç¬¬å››éƒ¨åˆ†ï¼šæåŒ»ç”Ÿ Chat SDK åˆå§‹åŒ– (åœ¨å³ä¾§)
        // =================================================================
        const client = new CozeWebSDK.WebChatClient({
            config: { bot_id: '7608863077597626394' },
            componentProps: { title: 'æåŒ»ç”Ÿå£è…”è¯Šå®¤', layout: 'pc' },
            auth: {
                type: 'token',
                token: 'pat_dT8ZNCudSDhO2DRLnZMtuuZNhBwOFt4gTbNjr25yPK6FtkC5hK9VmehDLKuSqR7w',
                onRefreshToken: () => 'pat_dT8ZNCudSDhO2DRLnZMtuuZNhBwOFt4gTbNjr25yPK6FtkC5hK9VmehDLKuSqR7w'
            },
            // ã€å…³é”®ã€‘å¼ºåˆ¶å–‚å…¥å…¨æ–°ç”Ÿæˆçš„ IDï¼Œè§£å†³è®°å¿†æ®‹ç•™é—®é¢˜
            userInfo: { 
                id: uniquePatientId, 
                name: 'è®¿å®¢-' + uniquePatientId.slice(-4) 
            },
            // éšè—ä¸éœ€è¦çš„è‡ªå¸¦æŒ‰é’®
            ui: { asstBtn: { isNeed: false } }
        });

        // å¼ºåˆ¶è‡ªåŠ¨å¼¹çª—ï¼Œè®©æåŒ»ç”Ÿç›´æ¥æ˜¾ç¤º
        client.showChatBot();
    </script>
</body>
</html>
